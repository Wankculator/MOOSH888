<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Debug Test - MOOSH Wallet</title>
    <link rel="stylesheet" href="css/app.css">
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            padding: 20px;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-button {
            padding: 10px 20px;
            background: #000;
            border: 2px solid #f57315;
            color: #f57315;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        
        .test-button:hover {
            background: #f57315;
            color: #000;
        }
    </style>
</head>
<body>
    <div id="app"></div>
    <div class="test-container">
        <h1 style="color: #f57315; text-align: center;">COLOR PICKER DEBUG</h1>
        
        <div style="text-align: center; margin: 40px 0;">
            <button class="test-button" onclick="debugColorPicker()">DEBUG COLOR PICKER</button>
            <button class="test-button" onclick="testDirectColors()">TEST DIRECT COLORS</button>
        </div>
        
        <div id="results" style="margin-top: 20px; background: #111; border: 1px solid #333; padding: 20px; white-space: pre-wrap; font-size: 12px;"></div>
    </div>
    
    <script src="js/moosh-wallet.js"></script>
    <script>
        function log(msg) {
            const results = document.getElementById('results');
            results.innerHTML += msg + '\n';
        }
        
        function debugColorPicker() {
            log('=== DEBUGGING COLOR PICKER ===');
            
            // Check if colors are defined
            const colors = window.app.state.getAccountColors();
            log(`Colors defined: ${colors.length} colors`);
            log(`Colors: ${JSON.stringify(colors)}`);
            
            // Get first account
            const accounts = window.app.state.get('accounts');
            if (accounts.length === 0) {
                log('ERROR: No accounts found');
                return;
            }
            
            // Open color picker
            const modal = new AccountListModal(window.app);
            modal.showColorPicker(accounts[0].id);
            
            // Check DOM after a short delay
            setTimeout(() => {
                const overlay = document.querySelector('[style*="position: fixed"]');
                if (!overlay) {
                    log('ERROR: Overlay not found');
                    return;
                }
                
                const colorDivs = overlay.querySelectorAll('div[style*="width: 60px"]');
                log(`Found ${colorDivs.length} color divs`);
                
                colorDivs.forEach((div, index) => {
                    const computed = window.getComputedStyle(div);
                    const bg = computed.backgroundColor;
                    const bgImage = computed.backgroundImage;
                    log(`Color ${index}: backgroundColor = ${bg}, backgroundImage = ${bgImage}`);
                    log(`  Style attribute: ${div.getAttribute('style')}`);
                });
                
                // Close overlay
                setTimeout(() => {
                    if (overlay.parentNode) {
                        overlay.parentNode.removeChild(overlay);
                    }
                }, 2000);
            }, 100);
        }
        
        function testDirectColors() {
            log('=== TESTING DIRECT COLOR RENDERING ===');
            
            const colors = window.app.state.getAccountColors();
            const container = document.createElement('div');
            container.style.cssText = 'display: grid; grid-template-columns: repeat(4, 60px); gap: 10px; margin: 20px 0;';
            
            colors.forEach((color, index) => {
                const div = document.createElement('div');
                div.style.cssText = `width: 60px; height: 60px; background-color: ${color}; border: 2px solid #333;`;
                container.appendChild(div);
                log(`Created div ${index} with color ${color}`);
            });
            
            document.getElementById('results').appendChild(container);
            log('Direct color divs added above - they should show colors');
        }
    </script>
</body>
</html>