<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Mode Buttons Test - MOOSH Wallet</title>
    <link rel="stylesheet" href="css/app.css">
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            padding: 20px;
        }
        
        #test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-button {
            padding: 15px 30px;
            background: #000;
            border: 2px solid #f57315;
            color: #f57315;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.2s ease;
            margin: 20px auto;
            display: block;
        }
        
        .test-button:hover {
            background: #f57315;
            color: #000;
        }
        
        .test-results {
            background: #111;
            border: 2px solid #333;
            padding: 20px;
            margin: 20px 0;
            white-space: pre-wrap;
        }
        
        .success { color: #69fd97; }
        .error { color: #ff4444; }
        .info { color: #00d4ff; }
        .warning { color: #f57315; }
    </style>
</head>
<body>
    <div id="app"></div>
    <div id="test-container">
        <h1 style="color: #f57315; text-align: center;">VIEW MODE BUTTONS TEST</h1>
        
        <button class="test-button" onclick="openModalAndTest()">OPEN ACCOUNT MANAGER & TEST</button>
        
        <div class="test-results" id="results">
            <span class="info">Click the button above to open the Account Manager and test view modes.</span>
        </div>
        
        <div style="background: #111; border: 2px solid #333; padding: 20px; margin: 20px 0;">
            <h3 style="color: #f57315;">What to Test:</h3>
            <ol style="color: #888; line-height: 1.8;">
                <li><strong style="color: #fff;">GRID Button:</strong> Should show accounts in card layout (default view)</li>
                <li><strong style="color: #fff;">LIST Button:</strong> Should show accounts in compact rows</li>
                <li><strong style="color: #fff;">DETAILS Button:</strong> Should show accounts in table format</li>
                <li><strong style="color: #fff;">Active Button Highlight:</strong> Current view button should be orange</li>
                <li><strong style="color: #fff;">View Persistence:</strong> Selected view should remain when switching accounts</li>
            </ol>
        </div>
    </div>
    
    <script src="js/moosh-wallet.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const time = new Date().toTimeString().split(' ')[0];
            results.innerHTML += `\n<span class="${type}">[${time}] ${message}</span>`;
        }
        
        function openModalAndTest() {
            results.innerHTML = '<span class="info">Opening Account Manager...</span>';
            
            // Open the modal
            const modal = new AccountListModal(window.app);
            modal.show();
            
            // Wait for modal to render
            setTimeout(() => {
                testViewModes();
            }, 500);
        }
        
        function testViewModes() {
            log('Testing view mode buttons...', 'info');
            
            // Find the modal
            const modalEl = document.querySelector('.account-list-modal');
            if (!modalEl) {
                log('ERROR: Modal not found!', 'error');
                return;
            }
            
            log('✓ Modal opened successfully', 'success');
            
            // Find view mode buttons
            const buttons = modalEl.querySelectorAll('.account-toolbar button');
            let gridBtn, listBtn, detailsBtn;
            
            buttons.forEach(btn => {
                if (btn.textContent === 'GRID') gridBtn = btn;
                else if (btn.textContent === 'LIST') listBtn = btn;
                else if (btn.textContent === 'DETAILS') detailsBtn = btn;
            });
            
            if (!gridBtn || !listBtn || !detailsBtn) {
                log('ERROR: View mode buttons not found!', 'error');
                return;
            }
            
            log('✓ Found all view mode buttons', 'success');
            
            // Test GRID view (should be default)
            const gridBg = window.getComputedStyle(gridBtn).backgroundColor;
            if (gridBg === 'rgb(245, 115, 21)') {
                log('✓ GRID view is active by default', 'success');
            } else {
                log('✗ GRID view is not highlighted as active', 'warning');
            }
            
            // Test LIST view
            log('\nClicking LIST button...', 'info');
            listBtn.click();
            
            setTimeout(() => {
                // Check if view changed
                const listViewEl = modalEl.querySelector('.account-grid');
                if (listViewEl && listViewEl.children.length > 0) {
                    const firstChild = listViewEl.children[0];
                    const display = window.getComputedStyle(firstChild).display;
                    if (display === 'flex') {
                        log('✓ LIST view activated (flex layout detected)', 'success');
                    } else {
                        log('✗ LIST view may not be working correctly', 'warning');
                    }
                }
                
                // Check button highlight
                const listBg = window.getComputedStyle(listBtn).backgroundColor;
                if (listBg === 'rgb(245, 115, 21)') {
                    log('✓ LIST button is highlighted', 'success');
                } else {
                    log('✗ LIST button not highlighted', 'warning');
                }
                
                // Test DETAILS view
                log('\nClicking DETAILS button...', 'info');
                detailsBtn.click();
                
                setTimeout(() => {
                    // Check for table header
                    const tableHeader = modalEl.querySelector('[style*="grid-template-columns"]');
                    if (tableHeader) {
                        log('✓ DETAILS view activated (table layout detected)', 'success');
                    } else {
                        log('✗ DETAILS view may not be working correctly', 'warning');
                    }
                    
                    // Check button highlight
                    const detailsBg = window.getComputedStyle(detailsBtn).backgroundColor;
                    if (detailsBg === 'rgb(245, 115, 21)') {
                        log('✓ DETAILS button is highlighted', 'success');
                    } else {
                        log('✗ DETAILS button not highlighted', 'warning');
                    }
                    
                    // Test going back to GRID
                    log('\nClicking GRID button to return...', 'info');
                    gridBtn.click();
                    
                    setTimeout(() => {
                        const gridViewEl = modalEl.querySelector('.account-grid');
                        if (gridViewEl && window.getComputedStyle(gridViewEl).display === 'grid') {
                            log('✓ GRID view reactivated successfully', 'success');
                        } else {
                            log('✗ GRID view may not be working correctly', 'warning');
                        }
                        
                        log('\n========== TEST COMPLETE ==========', 'info');
                        log('All view modes should be functional!', 'success');
                        log('\nManual verification:', 'info');
                        log('- Check that each view displays accounts differently', 'info');
                        log('- Verify the active button is highlighted in orange', 'info');
                        log('- Confirm views persist when performing actions', 'info');
                        
                    }, 500);
                }, 500);
            }, 500);
        }
    </script>
</body>
</html>