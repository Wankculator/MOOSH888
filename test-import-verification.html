<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import Verification</title>
    <style>
        body {
            font-family: 'JetBrains Mono', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
        }
        .test { margin: 20px 0; padding: 20px; border: 1px solid #0f0; }
        .success { color: #0f0; }
        .error { color: #f00; }
        button { 
            background: #000; 
            color: #0f0; 
            border: 1px solid #0f0; 
            padding: 10px 20px; 
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0f0;
            color: #000;
        }
    </style>
</head>
<body>
    <h1>üîç Import Functionality Verification</h1>
    
    <div class="test">
        <h2>Test 1: Check Import Enhancement Status</h2>
        <button onclick="checkImportEnhancement()">Run Test</button>
        <div id="test1-result"></div>
    </div>
    
    <div class="test">
        <h2>Test 2: Simulate Import Flow</h2>
        <button onclick="simulateImportFlow()">Run Test</button>
        <div id="test2-result"></div>
    </div>
    
    <div class="test">
        <h2>Test 3: Console Error Status</h2>
        <button onclick="checkConsoleErrors()">Check Console</button>
        <div id="test3-result"></div>
    </div>
    
    <script>
        function log(testId, msg, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            document.getElementById(`${testId}-result`).appendChild(div);
        }
        
        function checkImportEnhancement() {
            log('test1', 'Checking import enhancement...', 'info');
            
            // Check if MultiAccountModal exists
            if (window.MultiAccountModal) {
                log('test1', '‚úì MultiAccountModal found', 'success');
                
                // Check methods
                const methods = [
                    'createImportForm',
                    'createSeedImportForm', 
                    'createPrivateKeyImportForm',
                    'handleImportPrivateKey'
                ];
                
                methods.forEach(method => {
                    if (window.MultiAccountModal.prototype[method]) {
                        log('test1', `‚úì ${method} exists`, 'success');
                    } else {
                        log('test1', `‚úó ${method} missing`, 'error');
                    }
                });
                
                // Check if importAccount is enhanced
                if (window.AccountListModal) {
                    log('test1', '‚úì AccountListModal found', 'success');
                    if (window.AccountListModal.prototype.importAccount) {
                        log('test1', '‚úì importAccount method exists', 'success');
                    }
                }
            } else {
                log('test1', '‚úó MultiAccountModal not found', 'error');
            }
        }
        
        function simulateImportFlow() {
            log('test2', 'Simulating import flow...', 'info');
            
            try {
                // Create mock app object
                const mockApp = {
                    state: { 
                        get: () => [],
                        set: () => {}
                    },
                    uiPolish: {
                        showNotification: (msg, type) => {
                            log('test2', `Notification: ${msg} (${type})`, type === 'error' ? 'error' : 'success');
                        }
                    }
                };
                
                // Test MultiAccountModal creation
                if (window.MultiAccountModal) {
                    const modal = new MultiAccountModal(mockApp);
                    modal.isImporting = true;
                    modal.importMode = 'privatekey';
                    
                    log('test2', '‚úì Created MultiAccountModal in import mode', 'success');
                    
                    // Test form creation
                    if (modal.createImportForm) {
                        const form = modal.createImportForm();
                        if (form) {
                            log('test2', '‚úì Import form created successfully', 'success');
                        }
                    }
                    
                    // Test private key form
                    if (modal.createPrivateKeyImportForm) {
                        const pkForm = modal.createPrivateKeyImportForm();
                        if (pkForm) {
                            log('test2', '‚úì Private key form created successfully', 'success');
                        }
                    }
                }
                
                log('test2', 'Import flow simulation complete', 'success');
            } catch (error) {
                log('test2', `Error: ${error.message}`, 'error');
            }
        }
        
        let errorCount = 0;
        let warnCount = 0;
        
        // Monitor console errors
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.error = function(...args) {
            errorCount++;
            originalError.apply(console, args);
        };
        
        console.warn = function(...args) {
            warnCount++;
            originalWarn.apply(console, args);
        };
        
        function checkConsoleErrors() {
            log('test3', 'Checking console status...', 'info');
            
            // Check if fixes are loaded
            const scripts = [
                'critical-fixes.js',
                'console-fixes.js'
            ];
            
            scripts.forEach(script => {
                const loaded = Array.from(document.scripts).some(s => s.src.includes(script));
                if (loaded) {
                    log('test3', `‚úì ${script} loaded`, 'success');
                } else {
                    log('test3', `‚úó ${script} not loaded`, 'error');
                }
            });
            
            // Check error counts
            log('test3', `Console errors: ${errorCount}`, errorCount > 0 ? 'error' : 'success');
            log('test3', `Console warnings: ${warnCount}`, warnCount > 5 ? 'error' : 'success');
            
            // Check specific issues
            const multiWalletToggle = document.querySelector('script[src*="multi-wallet-toggle-integration.js"]');
            if (!multiWalletToggle) {
                log('test3', '‚úì Problematic multi-wallet-toggle script removed', 'success');
            } else {
                log('test3', '‚úó Multi-wallet-toggle script still present', 'error');
            }
            
            log('test3', 'Console check complete', 'info');
        }
        
        // Run initial check on load
        window.addEventListener('load', () => {
            console.log('=== Import Verification Test ===');
            console.log('Page loaded, checking status...');
            
            // Auto-run first test
            setTimeout(() => {
                checkImportEnhancement();
            }, 1000);
        });
    </script>
</body>
</html>